% 2. naloge

% f(x)=1+(1.9/(0.9−x)+2.0/(1.4−x)+0.9/(1.9−x)+2.9/(2.9−x)+3.9/(3.7−x))/1000
% Na (1.4,1.9)
a1 = 1.4;
b1 = 1.9;
f = @(x) 1 + 1/1000 * (1.9/(0.9-x) + 2.0/(1.4-x) + 0.9/(1.9-x) + 2.9/(2.9-x) + 3.9/(3.7-x));
Df = @(x) 1/1000 * (1.9/(0.9-x)^2 + 2.0/(1.4-x)^2 + 0.9/(1.9-x)^2 + 2.9/(2.9-x)^2 + 3.9/(3.7-x)^2);

x0 = 1.4 / 3 + 1.9 * 2/3;

g1 = @(x) 1/1000 * (1.9/(0.9-x) + 2.0/(1.4-x));
g2 = @(x) 1/1000 * (0.9/(1.9-x) + 2.9/(2.9-x) + 3.9/(3.7-x));
Dg1 = @(x) 1/1000 * (1.9/(0.9-x)^2 + 2.0/(1.4-x)^2);
Dg2 = @(x) 1/1000 * (0.9/(1.9-x)^2 + 2.9/(2.9-x)^2 + 3.9/(3.7-x)^2);

X = [x0];
i = 1;
tol = 1e-16;

while true
    x = X(i);
    koef1 = [1/(a1-x) 1; 1/(a1-x).^2 0]\[g1(x); Dg1(x)];
    koef2 = [1/(b1-x) 1; 1/(b1-x).^2 0]\[g2(x); Dg2(x)];
    %     h1 = @(x) koef1(1)./(a1-x) + koef1(2);
    %     h2 = @(x) koef2(1)./(b1-x) + koef2(2);
    %     h = @(x) 1 + h1(x) + h2(x);
    a = 1+koef1(2)+koef2(2);
    b = (1+koef1(2)+koef2(2))*(-a1 - b1) - koef1(1) - koef2(1);
    c = (1+koef1(2)+koef2(2))*(a1*b1) + koef1(1)*b1 + koef2(1)*a1;
    
    x1 = (-b + sqrt(b^2-4*a*c))/(2*a);
    x2 = (-b - sqrt(b^2-4*a*c))/(2*a);

    if (a1 <= x1) && (x1 <= b1)
        X(i+1) = x1;
    else
        X(i+1) = x2;
    end
    i = i+1;

    if abs(X(i) - X(i-1)) < tol
        break
    end
end